<%= form_for @profile, :url => profile_path(@profile), :html => { :multipart => true }, :remote => false do |f| %>
  <ul>
    <li id="error_messages">
      <%= f.error_messages :class => 'error', :header_message => nil, :message => nil, :header_tag => :p %>
    </li>
    <li>
      <%= f.label :first_name, t('user.model.first_name') %>
      <%= f.text_field :first_name, :class => '' %>
    </li>
    <li>
      <%= f.label :last_name, t('user.model.last_name') %>
      <%= f.text_field :last_name, :class => '' %>
    </li>
    <li>
      <label for='user_gender_female'><%= t('user.model.gender') %></label>
    </li>
    <li>
      <%= f.radio_button :gender, 'female' %>
      <%= f.label :gender_female, t('user.model.female') %>
    </li>
    <li>
      <%= f.radio_button :gender, 'male' %>
      <%= f.label :gender_male, t('user.model.male') %>
    </li>
    <li>
      <label for='user_birthday'><%= t('user.model.birthday') %></label>
      <%= f.select :birthday,
        options_for_select((1900..Time.now.year).to_a.reverse, @profile.birthday || '1980'),
        {:include_blank => 'select'} %>
    </li>
    <li>
      <label><%= t('user.model.receive_notifications') %></label>
    </li>
    <li>
      <%= f.radio_button :notifybyemail, 'yes' %>
      <%= f.label :notifybyemail_yes, t('user.model.yes_answer') %>
    </li>
    <li>
      <%= f.radio_button :notifybyemail, 'no' %>
      <%= f.label :notifybyemail_no, t('user.model.no_answer') %>
    </li>
    <li>
      <%= f.label :language_id, t('user.model.preferred_language') %>
      <%= f.select :language_id,
        options_for_select(Language.options_for_select, @profile.language_id),
        {:include_blank => 'select'} %>
    </li>
    <li>
      <%= f.label :avatar, 'user.model.avatar' %>
      <%= f.file_field :avatar %>
    </li>
    <%- unless @profile.new_record? || !@profile.avatar %>
      <%= f.label :avatar, 'user.model.remove_avatar' %>
      <%= image_tag @profile.avatar.url(:original), :class => 'float_right', :alt => 'Avatar', :title => 'Current avatar' %>
      <%= f.check_box :delete_avatar %>
    <%- end%>
    <li>
      <%= f.label :country_id, t('user.model.country') %>
      <%= id = @profile.country ? @profile.country.id : 0
      f.select :country_id,
        options_for_select(Country.options_for_select, id),
        {:include_blank => 'Please select'} %>
    </li>
    <li>
      <%= f.label :location_id, t('user.model.city') %>
      <%= loc = @profile.location ? @profile.location.city : ' '
      text_field_tag :user_location, loc, :disabled => true,
        :autocomplete => autocomplete_location_city_profiles_path
    %>
      <input type="hidden" value="<%= @profile.location_id %>" name="user[location_id]" id="user_location_id"/>
    </li>
  </ul>
  <p>
    <%= submit_tag t('views.submit'), :class=>:submission %>
  </p>
<%- end -%>
<%= javascript_tag "
$(function (){
$('#user_country_id').change(function(){
enable_city(this);
});
if ($('#user_country_id').val() != ''){ // It may be already selected
enable_city($('#user_country_id'), false);
}
});
"
%>
