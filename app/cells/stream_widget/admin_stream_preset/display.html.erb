<%= widget_div do %>
  <% if @stream_preset %>
    <%= form_for @stream_preset, :as => :stream_preset, :url => url_for_event(:submit), :remote => true do |f| -%>
      <%= f.hidden_field :id %>
      <%= f.label :name, 'Preset name' %>
      <%= f.text_field :name %>
      <%= f.label :is_active %>
      <%= f.check_box :is_active %>

      <div style="overflow: auto;height:260px;margin-bottom: 10px;border-bottom: 2px solid #aaa;">
        <table id="presets-table" style="border-collapse: collapse;border-spacing: 0;font-size:10px;margin: 10px 0 0;">
          <caption></caption>
          <thead>
            <tr>
              <th style="font-weight:normal;">Description</th>
              <th style="font-weight:normal;">Language</th>
              <th style="font-weight:normal;">Stream URL</th>
              <th style="font-weight:normal;">Inactive image</th>
              <th style="font-weight:normal;">Default</th>
              <th style="font-weight:normal;">X</th>
            </tr>
          </thead>

          <%= f.fields_for :stream_items do |stream_items| -%>
            <%= render :partial => "stream_items", :locals => { :stream_items => stream_items } %>
          <% end -%>
        </table>
      </div>
      <p style='float: left;'><%= link_to_add_fields 'Add stream item', f, :stream_items %></p>
      <%= f.submit "Submit", :style => 'float: right;', :class => 'button-small-main', :disable_with => 'Submitting...' %>

    <% end -%>
  <% else %>
    <div>
      Please select preset to edit or add new preset
    </div>
  <% end %>
  <div class="clear"></div>
<% end -%>

<%= javascript_tag do %>
  function add_field(link, association, content) {
  var new_id = new Date().getTime();
  var regexp = new RegExp("new_" + association, "g");
  content = content.replace(regexp, new_id)
  $('#presets-table').append(content);
  }

  function remove_field(link, is_new_record) {
  $(link).closest("div.add_other").children("p.add_other").children("a").show();
  if(is_new_record){
  $(link).parent().parent().remove();
  }
  else{
  $(link).prev("input[type=hidden]").val("1");
  $(link).parent().parent().hide();
  }
  }
  $('#preset_list li').live('click', function(){
    $('#preset_list li').css('font-weight', 'normal');
    $(this).css('font-weight', 'bold');
  });

<% end %>